% Fixed Parameters
Va = 1.5;        % Velocity (m/s)
N = 4000;      % RPM
D = 0.078;     % Diameter (m)
Z = 2;         % Number of Blades
Ae_Ao = 0.3;   % Open area ratio
P_D = 0.71;     % Pitch-to-diameter ratio

% Advance ratio calculation
J = (Va / ((N/60) * D));

C_1=0.00880496; C_2=-0.204554; C_3=0.166351; C_4= 0.158114; C_5= -0.147581;
C_6=- 0.481497; C_7=0.415437; C_8=0.0144043; C_9=-0.0530054; C_10=0.0143481;
C_11=0.0606826; C_12= -0.0125894; C_13=0.0109689; C_14=-0.133698; C_15=0.00638407;
C_16=-0.00132718; C_17=0.168496; C_18=-0.0507214; C_19=0.0854559; C_20=-0.0504475;
C_21=0.010465; C_22= -0.00648272; C_23= -0.00841728; C_24=0.0168424; C_25= -0.00102296;
C_26= -0.0317791; C_27= 0.018604; C_28= -0.00410798; C_29= -0.000606848; C_30= -0.0049819;
C_31= 0.0025983; C_32= -0.000560528; C_33= -0.00163652; C_34= -0.000328787; C_35= 0.000116502;
C_36= 0.000690904; C_37=0.00421749; C_38= 0.0000565229; C_39= -0.00146564;

KT_1= C_1+ C_2*J+ C_3*P_D+ C_4*(P_D)^2 +C_5*J^2*Ae_Ao;
KT_2= C_6*J*P_D*Ae_Ao+ C_7*P_D^2*Ae_Ao+ C_8*Z+ C_9*J^2*Z+ C_10*P_D*Z;
KT_3= C_11*J*P_D*Z+ C_12*Ae_Ao*Z+ C_13*J*Ae_Ao*Z+ C_14*P_D^3+ C_15*P_D^6;
KT_4= C_16*J^2+P_D^6+ C_17*J^3*Ae_Ao+ C_18*Ae_Ao^2+ C_19*J^2*Ae_Ao^2+ C_20*J^3*Ae_Ao^2;
KT_5= C_21*J*P_D^6*Ae_Ao^2+ C_22*J^2*P_D^6*Ae_Ao^2+C_23*P_D^3*Z+ C_24*J*P_D^3*Z+C_25*J^3*P_D^3*Z;
KT_6= C_26*P_D^3*Ae_Ao*Z+C_27*J*Ae_Ao^2*Z+C_28*P_D^2*Ae_Ao^2*Z+C_29*Z^2+C_30*J*Z^2;
KT_7=C_31*J^2*Z^2+C_32*J^3*Z^2+C_33*J*P_D^2*Z^2+C_34*J*P_D^6*Z^2+C_35*J^2*P_D^6*Z^2;
KT_8=C_36*Ae_Ao*Z^2+ C_37*P_D^3*Ae_Ao*Z^2+ C_38*J^3*P_D^6*Ae_Ao*Z^2+C_39*P_D^3*Ae_Ao^2*Z^2;

KT= KT_1+KT_2+ KT_3+ KT_4+ KT_5+ KT_6+ KT_7+ KT_8;

CQ_1= 0.00379368; CQ_2= 0.00886523; CQ_3= -0.032241; CQ_4= 0.00344778; CQ_5= -0.0408811;
CQ_6= -0.108009; CQ_7= -0.0885381; CQ_8= 0.188561; CQ_9= -0.00370871; CQ_10= 0.00513696;
CQ_11= 0.0209449; CQ_12= 0.00474319; CQ_13= -0.00723408; CQ_14= 0.00438388; CQ_15= -0.0269403;
CQ_16= 0.0558082; CQ_17= 0.0161886; CQ_18= 0.00318086; CQ_19= 0.015896; CQ_20= 0.0471729;
CQ_21= 0.0196283; CQ_22= -0.0502782; CQ_23= -0.030055; CQ_24= 0.0417122; CQ_25= -0.0397722;
CQ_26= -0.00350024; CQ_27= -0.0106854; CQ_28= 0.00110903; CQ_29= -0.000313912; CQ_30= 0.0035985;
CQ_31= -0.00142121; CQ_32= -0.00383637; CQ_33= 0.0126803; CQ_34= -0.00318278; CQ_35= 0.00334268;
CQ_36= -0.00183491; CQ_37= 0.000112451; CQ_38= -0.0000297228; CQ_39= 0.000269551; CQ_40= 0.00083265;
CQ_41= 0.00155334; CQ_42= 0.000302683; CQ_43= -0.0001843; CQ_44= -0.000425399; CQ_45= 0.0000869243;
CQ_46= -0.0004659; CQ_47= 0.0000554194;

KQ_1= CQ_1+ CQ_2*J^2+ CQ_3*J*P_D+ CQ_4*P_D^2+ CQ_5*P_D*Ae_Ao;
KQ_2= CQ_6*J*P_D*Ae_Ao+ CQ_7*J^2*P_D*Ae_Ao+CQ_8*P_D^2*Ae_Ao+CQ_9*J*Z+CQ_10*P_D*Z;
KQ_3= CQ_11*J*P_D*Z+ CQ_12*J^2*P_D*Z+ CQ_13*J^2*Ae_Ao*Z+ CQ_14*J*P_D*Ae_Ao*Z+ CQ_15*P_D^2*Ae_Ao*Z;
KQ_4= CQ_16*J^3*Ae_Ao+ CQ_17*P_D^3*Ae_Ao+ CQ_18*J*P_D^3*Ae_Ao+ CQ_19*Ae_Ao^2+CQ_20*J*Ae_Ao^2;
KQ_5= CQ_21*J^3*Ae_Ao^2+ CQ_22*P_D*Ae_Ao^2+CQ_23*J^3*P_D*Ae_Ao^2+CQ_24*J^2*P_D^2*Ae_Ao^2+ CQ_25*P_D^3*Ae_Ao^2;
KQ_6= CQ_26*P_D^6*Ae_Ao^2+ CQ_27*J^3*Z+ CQ_28*J^3*P_D^3*Z+ CQ_29*P_D^6*Z+ CQ_30*J^3*Ae_Ao*Z;
KQ_7= CQ_31*P_D^6*Z+ CQ_32*J*Ae_Ao^2*Z+ CQ_33*P_D^2*Ae_Ao^2*Z+CQ_34*J^2*P_D^3*Ae_Ao^2*Z+ CQ_35*P_D^6*Ae_Ao^2*Z;
KQ_8= CQ_36*J*P_D*Z^2+ CQ_37*J^3*P_D^2*Z^2+ CQ_38*J^3*P_D^6*Z^2+ CQ_39*J*Ae_Ao*Z^2+ CQ_40*J^2*Ae_Ao*Z^2;
KQ_9= CQ_41*P_D^2*Ae_Ao*Z^2+ CQ_42*P_D^6*Ae_Ao*Z^2+ CQ_43*Ae_Ao^2*Z^2+ CQ_44*P_D^3*Ae_Ao^2*Z^2+ CQ_45*J^3*P_D^3*Ae_Ao^2*Z^2;
KQ_10= CQ_46*P_D^6*Ae_Ao^2*Z^2+ CQ_47*J*P_D^6*Ae_Ao^2*Z^2;

KQ= KQ_1+ KQ_2+ KQ_3+ KQ_4+ KQ_5+ KQ_6+ KQ_7+ KQ_8+ KQ_9+KQ_10;

Q= KQ*1025*(N/60)^2*D^5;
T=KT*1025*(N/60)^2*D^4;





